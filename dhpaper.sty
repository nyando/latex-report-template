% dhpaper.sty
\ProvidesPackage{dhpaper}[2020/09/26 v1.0]

% set geometry to 2.5cm margins all around
\usepackage[margin=2.5cm]{geometry}

% language and typesetting settings
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[babel,german=guillemets]{csquotes}
\usepackage{microtype}

% better color names
\usepackage[dvipsnames,table]{xcolor}

% spacing, tables, tabs
\usepackage{xspace}
\usepackage{array}
\usepackage{tabularx}
\usepackage{needspace}

% euro and math symbols
\usepackage{eurosym}
\usepackage{amssymb}

% graphics and pdf packages
\usepackage{pdfpages}
\usepackage{graphicx}
\usepackage{framed}
\usepackage[hypcap=false]{caption}

% in-document links
\usepackage[bookmarksopen,bookmarksnumbered]{hyperref}
\usepackage{bookmark}

% header styles
\usepackage[headings]{fullpage}
\usepackage{fancyhdr}

% glossary and abbreviations
\usepackage[toc,acronym]{glossaries}

% set up biblatex
\usepackage[
    hyperref    = true,
    backref     = true,
    bibencoding = inputenc,
    style       = authoryear-comp,
    backend     = bibtex,
    sorting     = nty
]{biblatex}
\renewcommand{\bibitemsep}{1ex}
\renewcommand{\bibleftparen}{[}
\renewcommand{\bibrightparen}{]}

% redefine cite without parentheses as default
\let\citeNoParen\cite
\let\cite\parencite

% code listings
\usepackage{listings}
\renewcommand{\lstlistingname}{Listing}
\renewcommand{\lstlistlistingname}{Codelistingverzeichnis}

% line spacing factor
\usepackage{setspace}

% title page content
\newcommand*{\projecttitle}[1]{\gdef\@projecttitle{#1}}
\newcommand*{\@projecttitle}{Titel}
\newcommand*{\projecttype}[1]{\gdef\@projecttype{#1}}
\newcommand*{\@projecttype}{Projektarbeit}
\newcommand*{\projectauthor}[1]{\gdef\@projectauthor{#1}}
\newcommand*{\@projectauthor}{Vorname Nachname}
\newcommand*{\studentid}[1]{\gdef\@studentid{#1}}
\newcommand*{\@studentid}{Matrikelnummer}

\newcommand*{\companyname}[1]{\gdef\@companyname{#1}}
\newcommand*{\@companyname}{Firmenname}
\newcommand*{\companylocation}[1]{\gdef\@companylocation{#1}}
\newcommand*{\@companylocation}{Firmensitz}
\newcommand*{\companylogo}[1]{\gdef\@companylogo{#1}}
\newcommand*{\@companylogo}{lion}
\newcommand*{\companyadvisor}[1]{\gdef\@companyadvisor{#1}}
\newcommand*{\@companyadvisor}{Vorname Nachname}

\newcommand*{\schoolname}[1]{\gdef\@schoolname{#1}}
\newcommand*{\@schoolname}{Dualen Hochschule Baden-Württemberg Karlsruhe}
\newcommand*{\schoollogo}[1]{\gdef\@schoollogo{#1}}
\newcommand*{\@schoollogo}{dhbw-logo}
\newcommand*{\schooladvisor}[1]{\gdef\@schooladvisor{#1}}
\newcommand*{\@schooladvisor}{Vorname Nachname}

\newcommand*{\deadline}[1]{\gdef\@deadline{#1}}
\newcommand*{\@deadline}{01.01.1970}
\newcommand*{\duration}[1]{\gdef\@duration{#1}}
\newcommand*{\@duration}{1000 Jahre}

\newcommand*{\degreetype}[1]{\gdef\@degreetype{#1}}
\newcommand*{\@degreetype}{Professor of Science}
\newcommand*{\subject}[1]{\gdef\@subject{#1}}
\newcommand*{\@subject}{Universalwissenschaften}
\newcommand*{\courseid}[1]{\gdef\@courseid{#1}}
\newcommand*{\@courseid}{WTF19BBQ}

% redefine maketitle command to create a neato title page
\renewcommand*{\maketitle}{
    \begin{titlepage}
        \begin{center}
            \vspace*{-2cm}
            {\includegraphics[width=4cm]{\@companylogo}\hfill\includegraphics[width=4cm]{\@schoollogo}} \\
            \vspace*{2cm}
            {\Huge \@projecttitle} \\
            \vspace*{1cm}
            {\Huge\scshape \@projecttype} \\
            \vspace*{1cm}
            {\large für die Prüfung zum} \\
            \vspace*{0.5cm}
            {\Large \@degreetype} \\
            \vspace*{0.5cm}
            {\large des Studienganges \@subject} \\
            \vspace*{0.5cm}
            {\large an der} \\
            \vspace*{0.5cm}
            {\large \@schoolname} \\
            \vspace*{0.5cm}
            {\large von} \\
            \vspace*{0.5cm}
            {\large\bfseries \@projectauthor} \\
            \vspace*{1cm}
            {\large Abgabedatum \@deadline} \\
            \vfill
        \end{center}
        \begin{tabular}{l@{\hspace{2cm}}l}
            Bearbeitungszeitraum          & \@duration         \\
            Matrikelnummer                & \@studentid        \\
            Kurs                          & \@courseid         \\
            Ausbildungsfirma              & \@companyname      \\
                                          & \@companylocation  \\
            Betreuer der Ausbildungsfirma & \@companyadvisor   \\
            Gutachter der Studienakademie & \@schooladvisor      \\
        \end{tabular}
    \end{titlepage}
}

\lstdefinestyle{dhpaperdefault}{
    basicstyle=\linespread{1.0}\normalsize\ttfamily,
    keepspaces=false,
    keywordstyle=\color{Fuchsia},
    identifierstyle=\color{MidnightBlue},
    commentstyle=\color{Green},
    stringstyle=\color{Mahogany},
    columns=flexible
}